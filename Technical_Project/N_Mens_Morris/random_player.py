import random
import numpy as np
import networkx as nx

adj_3 = [[0,1,0,1,1,0,0,0,0],
       [1,0,1,0,1,0,0,0,0],
       [0,1,0,0,1,1,0,0,0],
       [1,0,0,0,1,0,1,0,0],
       [1,1,1,1,0,1,1,1,1],
       [0,0,1,0,1,0,0,0,1],
       [0,0,0,1,1,0,0,1,0],
       [0,0,0,0,1,0,1,0,1],
       [0,0,0,0,1,1,0,1,0]]


adj_dict_3 = {
"[0, 0]": [[0,1], [1,0], [1,1]],
"[0, 1]": [[0,0], [0,2], [1,1]],
"[0, 2]": [[0,1], [1,1], [1,2]],
"[1, 0]": [[0,0], [1,1], [2,0]],
"[1, 1]": [[0,0], [0,1], [0,2], [1,0], [1,2], [2,0], [2,1], [2,2]],
"[1, 2]": [[0,2], [1,1], [2,2]],
"[2, 0]": [[2,1], [1,0], [1,1]],
"[2, 1]": [[2,0], [2,2], [1,1]],
"[2, 2]": [[2,1], [1,1], [1,2]],
}

mill_dict_3 = {
"[0, 0]": [[[0,1], [0,2]], [[1,0], [2,0]], [[1,1], [2,2]]],
"[0, 1]": [[[0,0], [0,2]], [[1,1], [2,1]]],
"[0, 2]": [[[1,2], [2,2]], [[1,1], [2,0]], [[0,0], [0,1]]],
"[1, 0]": [[[0,0], [2,0]], [[1,1], [1,2]]],
"[1, 1]": [[[0,0], [2,2]], [[0,1], [2,1]], [[0,2], [2,0]], [[1,0], [1,2]]],
"[1, 2]": [[[0,2], [2,2]], [[1,1], [1,0]]],
"[2, 0]": [[[2,1], [2,2]], [[1,1], [0,2]], [[0,0], [1,0]]],
"[2, 1]": [[[2,0], [2,2]], [[1,1], [0,1]]],
"[2, 2]": [[[2,1], [2,0]], [[1,2], [0,2]], [[0,0], [1,1]]]
}

adj_6 = [[0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
       [1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0],
       [0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
       [0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0],
       [0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0],
       [0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0],
       [1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0],
       [0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0],
       [0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],
       [0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1],
       [0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0],
       [0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0],
       [0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0],
       [0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],
       [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1],
       [0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0]]

adj_dict_6 = {
"[0, 0]": [[0,1], [2,0]],
"[0, 1]": [[0,0], [0,2], [1,1]],
"[0, 2]": [[0,1], [2,3]],
"[1, 0]": [[1,1], [2,1]],
"[1, 1]": [[0,1], [1,0], [1,2]],
"[1, 2]": [[1,1], [2,2]],
"[2, 0]": [[2,1], [0,0], [4,0]],
"[2, 1]": [[3,0], [1,0], [2,0]],
"[2, 2]": [[3,2], [1,2], [2,3]],
"[2, 3]": [[0,2], [2,2], [4,2]],
"[3, 0]": [[2,1], [3,1]],
"[3, 1]": [[3,2], [4,1], [3,0]],
"[3, 2]": [[2,2], [3,1]],
"[4, 0]": [[4,1], [2,0]],
"[4, 1]": [[4,0], [4,2], [3,1]],
"[4, 2]": [[2,3], [4,1]]
}

mill_dict_6 = {
"[0, 0]": [[[0,1], [0,2]], [[4,0], [2,0]]],
"[0, 1]": [[[0,0], [0,2]]],
"[0, 2]": [[[2,3], [4,2]], [[0,0], [0,1]]],
"[1, 0]": [[[3,0], [2,1]], [[1,1], [1,2]]],
"[1, 1]": [[[1,0], [1,2]]],
"[1, 2]": [[[3,2], [2,2]], [[1,1], [1,0]]],
"[2, 0]": [[[0,0], [4,0]]],
"[2, 1]": [[[3,0], [1,0]]],
"[2, 2]": [[[1,2], [3,2]]],
"[2, 3]": [[[0,2], [4,2]]],
"[3, 0]": [[[1,0], [2,1]], [[3,1], [3,2]]],
"[3, 1]": [[[3,0], [3,2]]],
"[3, 2]": [[[3,1], [3,0]], [[1,2], [2,2]]],
"[4, 0]": [[[2,0], [0,0]], [[4,1], [4,2]]],
"[4, 1]": [[[4,0], [4,2]]],
"[4, 2]": [[[2,3], [0,2]], [[4,0], [4,1]]]
}

adj_9 = np.matrix([[0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],
                   [1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0],
                   [0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0],
                   [0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],
                   [0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0],
                   [0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1],
                   [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0]])

adj_dict_9 = {
"[0, 0]": [[0,1], [3,0]],
"[0, 1]": [[0,0], [0,2], [1,1]],
"[0, 2]": [[0,1], [3,5]],
"[1, 0]": [[1,1], [3,1]],
"[1, 1]": [[0,1], [1,0], [1,2], [2,1]],
"[1, 2]": [[1,1], [3,4]],
"[2, 0]": [[2,1], [3,2]],
"[2, 1]": [[1,1], [2,0], [2,2]],
"[2, 2]": [[3,3], [2,1]],
"[3, 0]": [[0,0], [6,0], [3,1]],
"[3, 1]": [[3,2], [5,0], [1,0], [3,0]],
"[3, 2]": [[2,0], [4,0], [3,1]],
"[3, 3]": [[2,2], [4,2], [3,4], [3,5]],
"[3, 4]": [[3,5], [5,2], [1,2]],
"[3, 5]": [[0,2], [6,2], [3,4]],
"[4, 0]": [[3,2], [4,0]],
"[4, 1]": [[4,0], [4,2], [5,1]],
"[4, 2]": [[3,3], [4,1]],
"[5, 0]": [[3,1], [5,1]],
"[5, 1]": [[5,0], [5,2], [3,1], [6,1]],
"[5, 2]": [[5,1], [3,4]],
"[6, 0]": [[3,0], [6,1]],
"[6, 1]": [[6,0], [6,2], [5,1]],
"[6, 2]": [[6,1], [3,5]]
}

mill_dict_9 = {
"[0, 0]": [[[0,1], [0,2]], [[3,0], [6,0]]],
"[0, 1]": [[[0,0], [0,2]], [[2,1], [1,1]]],
"[0, 2]": [[[0,0], [0,1]], [[3,5], [6,2]]],
"[1, 0]": [[[5,0], [3,1]], [[1,1], [1,2]]],
"[1, 1]": [[[1,0], [1,2]], [[0,1], [2,1]]],
"[1, 2]": [[[3,4], [5,2]], [[1,1], [1,0]]],
"[2, 0]": [[[3,2], [4,0]], [[2,1], [2,2]]],
"[2, 1]": [[[2,0], [2,2]], [[0,1], [1,1]]],
"[2, 2]": [[[3,3], [4,2]], [[2,0], [2,1]]],
"[3, 0]": [[[3,1], [3,2]], [[0,0], [6,0]]],
"[3, 1]": [[[3,0], [3,2]], [[1,0], [5,0]]],
"[3, 2]": [[[2,0], [4,0]], [[3,0], [3,2]]],
"[3, 3]": [[[2,2], [4,2]], [[3,4], [3,5]]],
"[3, 4]": [[[3,3], [3,5]], [[1,2], [5,2]]],
"[3, 5]": [[[0,2], [6,2]], [[3,3], [3,4]]],
"[4, 0]": [[[2,0], [3,2]], [[4,1], [4,2]]],
"[4, 1]": [[[4,0], [4,2]], [[5,1], [6,1]]],
"[4, 2]": [[[3,3], [2,2]], [[4,0], [4,1]]],
"[5, 0]": [[[3,1], [1,0]], [[5,1], [5,2]]],
"[5, 1]": [[[5,0], [5,2]], [[3,1], [1,0]]],
"[5, 2]": [[[5,1], [5,0]], [[1,2], [3,4]]],
"[6, 0]": [[[3,0], [0,0]], [[6,1], [6,2]]],
"[6, 1]": [[[6,0], [6,2]], [[4,1], [5,1]]],
"[6, 2]": [[[6,0], [6,1]], [[0,2], [3,5]]]
}

adj_12 = np.matrix([[0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
                   [1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                   [0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],
                   [1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0],
                   [0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0],
                   [0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],
                   [0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],
                   [0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0],
                   [0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1],
                   [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
                   [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,0,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1],
                   [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1],
                   [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0]])

adj_dict_12 = {
"[0, 0]": [[0,1], [3,0], [1,0]],
"[0, 1]": [[0,0], [0,2], [1,1]],
"[0, 2]": [[0,1], [3,5], [1,2]],
"[1, 0]": [[1,1], [3,1], [0,0], [2,0]],
"[1, 1]": [[0,1], [1,0], [1,2], [2,1]],
"[1, 2]": [[1,1], [3,4], [0,2], [2,2]],
"[2, 0]": [[2,1], [3,2], [1,0]],
"[2, 1]": [[1,1], [2,0], [2,2]],
"[2, 2]": [[3,3], [2,1], [1,2]],
"[3, 0]": [[0,0], [6,0], [3,1]],
"[3, 1]": [[3,2], [5,0], [1,0], [3,0]],
"[3, 2]": [[2,0], [4,0], [3,1]],
"[3, 3]": [[2,2], [4,2], [3,4]],
"[3, 4]": [[3,5], [5,2], [1,2], [3,3]],
"[3, 5]": [[0,2], [6,2], [3,4]],
"[4, 0]": [[3,2], [4,0], [5,0]],
"[4, 1]": [[4,0], [4,2], [5,1]],
"[4, 2]": [[3,3], [4,1], [5,2]],
"[5, 0]": [[3,1], [5,0], [4,0], [6,0]],
"[5, 1]": [[5,0], [5,2], [3,1], [6,1]],
"[5, 2]": [[5,1], [3,4], [4,2], [5,2]],
"[6, 0]": [[3,0], [6,1], [5,0]],
"[6, 1]": [[6,0], [6,2], [5,1]],
"[6, 2]": [[6,1], [3,5], [5,2]]
}

mill_dict_12 = {
"[0, 0]": [[[0,1], [0,2]], [[3,0], [6,0]], [[1,0], [2,0]]],
"[0, 1]": [[[0,0], [0,2]], [[2,1], [1,1]]],
"[0, 2]": [[[0,0], [0,1]], [[3,5], [6,2]], [[1,2], [2,2]]],
"[1, 0]": [[[5,0], [3,1]], [[1,1], [1,2]], [[0,0], [2,0]]],
"[1, 1]": [[[1,0], [1,2]], [[0,1], [2,1]]],
"[1, 2]": [[[3,4], [5,2]], [[1,1], [1,0]], [[0,2], [2,2]]],
"[2, 0]": [[[3,2], [4,0]], [[2,1], [2,2]], [[1,0], [0,0]]],
"[2, 1]": [[[2,0], [2,2]], [[0,1], [1,1]]],
"[2, 2]": [[[3,3], [4,2]], [[2,0], [2,1]], [[1,2], [0,2]]],
"[3, 0]": [[[3,1], [3,2]], [[0,0], [6,0]]],
"[3, 1]": [[[3,0], [3,2]], [[1,0], [5,0]]],
"[3, 2]": [[[2,0], [4,0]], [[3,0], [3,2]]],
"[3, 3]": [[[2,2], [4,2]], [[3,4], [3,5]]],
"[3, 4]": [[[3,3], [3,5]], [[1,2], [5,2]]],
"[3, 5]": [[[0,2], [6,2]], [[3,3], [3,4]]],
"[4, 0]": [[[2,0], [3,2]], [[4,1], [4,2]], [[5,0], [6,0]]],
"[4, 1]": [[[4,0], [4,2]], [[5,1], [6,1]]],
"[4, 2]": [[[3,3], [2,2]], [[4,0], [4,1]], [[5,2], [6,2]]],
"[5, 0]": [[[3,1], [1,0]], [[5,1], [5,2]], [[4,0], [6,0]]],
"[5, 1]": [[[5,0], [5,2]], [[3,1], [1,0]]],
"[5, 2]": [[[5,1], [5,0]], [[1,2], [3,4]], [[4,2], [6,2]]],
"[6, 0]": [[[3,0], [0,0]], [[6,1], [6,2]], [[4,0], [5,0]]],
"[6, 1]": [[[6,0], [6,2]], [[4,1], [5,1]]],
"[6, 2]": [[[6,0], [6,1]], [[0,2], [3,5]], [[4,2], [5,2]]]
}

class Random_Player(object):
    def __init__(self, player):
        self.player = player

    def place(self,state,free_space):
        temp = random.randint(0, len(free_space) - 1)
        return free_space[temp]

    def valid_move(self, state, game_type, free_space, pieces):
        valid_moves = []

        if game_type == 3:
            for piece in pieces:
                for space in adj_dict_3[str(piece)]:
                    if space in free_space:
                        valid_moves.append((piece,space))

        if game_type == 6:
            for piece in pieces:
                for space in adj_dict_6[str(piece)]:
                    if space in free_space:
                        valid_moves.append((piece,space))

        if game_type == 9:
            for piece in pieces:
                for space in adj_dict_9[str(piece)]:
                    if space in free_space:
                        valid_moves.append((piece,space))

        if game_type == 12:
            for piece in pieces:
                for space in adj_dict_12[str(piece)]:
                    if space in free_space:
                        valid_moves.append((piece,space))

#        print(valid_moves)
        return valid_moves

    def remove_piece(self, piece_list):
        temp = random.randint(0, len(piece_list) - 1)
        return piece_list[temp]

    def move(self, state, game_type, free_space, pieces):
        valid_moves = self.valid_move(state, game_type, free_space,pieces)
        if len(valid_moves) == 0:
            return ([9,9], [9,9])
        temp = random.randint(0, len(valid_moves) - 1)
#        prev_pos, move = valid_moves[temp]
        return valid_moves[temp]
